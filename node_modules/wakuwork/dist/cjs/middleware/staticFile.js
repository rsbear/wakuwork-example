"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:()=>_default});const _nodePath=_interopRequireDefault(require("node:path"));const _nodeFs=_interopRequireDefault(require("node:fs"));const _mime=_interopRequireDefault(require("mime"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const staticFile=config=>{const dir=_nodePath.default.resolve(config.prdServer?.dir||".");const publicPath=config.files?.public||"public";return async(req,res,next)=>{const url=new URL(req.url||"","http://"+req.headers.host);const fname=_nodePath.default.join(dir,publicPath,decodeURIComponent(url.pathname));const stat=_nodeFs.default.statSync(fname,{throwIfNoEntry:false});if(stat?.isFile()){res.setHeader("Content-Length",stat.size);res.setHeader("Content-Type",_mime.default.getType(_nodePath.default.extname(fname))||"application/octet-stream");_nodeFs.default.createReadStream(fname).pipe(res);return}await next()}};const _default=staticFile;